-- Load Rayfield Library (Make sure it's correctly installed)
local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()

-- Variables for Auto Hit and Auto Buy
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")
local breakables = workspace.GameObjects.Breakables
local autoHitEnabled = false
local autoBuyEnabled = false
local lastBreakableName = nil -- Track the current breakable's name

-- Function to find the nearest breakable
local function getNearestBreakable()
    local nearest = nil
    local minDistance = math.huge
    for _, breakable in ipairs(breakables:GetChildren()) do
        if breakable:IsA("BasePart") and breakable.Parent then
            local distance = (hrp.Position - breakable.Position).Magnitude
            if distance < minDistance then
                minDistance = distance
                nearest = breakable
            end
        end
    end
    return nearest
end

-- Function to teleport to the breakable, hit it, and wait until it disappears
local function teleportAndHit(breakable)
    if breakable and breakable:IsA("BasePart") then
        character:SetPrimaryPartCFrame(breakable.CFrame)
        lastBreakableName = breakable.Name -- Store the current breakable's name

        -- Auto-hit the breakable repeatedly until it disappears
        repeat
            -- Hit the breakable
            local args = { [1] = breakable.Name }
            game:GetService("ReplicatedStorage")
                :WaitForChild("Packages")
                :WaitForChild("Knit")
                :WaitForChild("Services")
                :WaitForChild("BreakableService")
                :WaitForChild("RF")
                :WaitForChild("HitBreakable")
                :InvokeServer(unpack(args))

            wait(0.05) -- Hit every 0.05 seconds
        until not breakables:FindFirstChild(lastBreakableName)
    end
end

-- Function to auto-hit the nearest breakable continuously
local function autoHit()
    spawn(function()
        while autoHitEnabled do
            local nearestBreakable = getNearestBreakable()
            if nearestBreakable then
                teleportAndHit(nearestBreakable) -- Teleport and hit the breakable
            end
            wait(0.1) -- Small delay between each search for a new breakable
        end
    end)
end

-- Function to auto-buy from the merchant
local function autoBuy()
    spawn(function()
        while autoBuyEnabled do
            local args = {
                [1] = "Zombie Merchant", -- Merchant name
                [2] = 5 -- Quantity
            }

            -- Invoke the buy function
            game:GetService("ReplicatedStorage")
                :WaitForChild("Packages")
                :WaitForChild("Knit")
                :WaitForChild("Services")
                :WaitForChild("LimitedMerchantService")
                :WaitForChild("RF")
                :WaitForChild("BuyItem")
                :InvokeServer(unpack(args))

            wait(1) -- Adjust delay as needed
        end
    end)
end

-- Rayfield GUI Setup
local Window = Rayfield:CreateWindow({
    Name = "ruthie2188 discord script",
    LoadingTitle = "Initializing...",
    LoadingSubtitle = "by pizzameboi",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "AutoFarmTool"
    }
})

local TabFarm = Window:CreateTab("Auto Farm", 4483362458)

-- Toggle for Auto Farm
TabFarm:CreateToggle({
    Name = "Auto Farm",
    CurrentValue = false,
    Flag = "AutoFarmToggle",
    Callback = function(value)
        autoHitEnabled = value
        if autoHitEnabled then
            autoHit() -- Start auto-hitting when enabled
        end
    end
})

local TabBuy = Window:CreateTab("Auto Buy", 4483362458)

-- Toggle for Auto Buy
TabBuy:CreateToggle({
    Name = "Skeleton Ducks",
    CurrentValue = false,
    Flag = "AutoBuyToggle",
    Callback = function(value)
        autoBuyEnabled = value
        if autoBuyEnabled then
            autoBuy() -- Start auto-buying when enabled
        end
    end
})

Rayfield:Notify({
    Title = "Auto Farm and Auto Buy Tool",
    Content = "Loaded successfully!",
    Duration = 5,
    Image = 4483362458
})
